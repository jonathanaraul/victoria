{% extends "ProyectoPrincipalBundle:Helpers2:baseInterna.html.twig" %}
{%block js%}
<script type="text/javascript">
var eliminarPagina = '{{path('proyecto_principal_page_delete')}}';
var cambiarStatusPagina = '{{path('proyecto_principal_page_status')}}';

</script>
{%endblock%}

{%block contents%} <td id="contents"><!-- whole contents -->
<div id="sf_admin_container">
	<h1>Listado de p√°ginas</h1>
	<div id="sf_admin_header"></div>
	<div id="sf_admin_bar">
		<div class="sf_admin_filters">
			<form id="filter-form" action="{{ url }}" method="post" {{ form_enctype(form) }}>
				<fieldset>
					<h2>Filtros</h2>
					<div class="form-row">
						<label for="parent_page_id">paginas relacionadas:</label>
						<div class="content">
							{{ form_widget(form.parentPage, { 'attr': {'class': 'theme_toggle'} }) }}
						</div>
					</div>
					<div class="form-row">
						<label for="theme_id">Tema:</label>
						<div class="content">
							{{ form_widget(form.theme, { 'attr': {'class': 'theme_toggle'} }) }}
						</div>
					</div>
					<div class="form-row">
						<label for="name">Nombre:</label>
						<div class="content">
							{{ form_widget(form.name, { 'attr': {'size': '15'} }) }}
						</div>
					</div>
					<div class="form-row">
						<label for="published">Publicado:</label>
						<div class="content">
							{{ form_widget(form.published, { 'attr': {'class': 'theme_toggle'} }) }}
						</div>
					</div>
				</fieldset>
				<ul class="sf_admin_actions">
					<li>
						<input class="sf_admin_action_reset_filter" value="Mostrar todo" type="button" onclick="document.location.href='{{path('proyecto_principal_page_list')}}';">
					</li>
					<li>
						<input type="submit" name="filter" value="Filtro" >
					</li>
				</ul>
				<div style="display: none">
					{{ form_rest(form) }}
				</div>
			</form>
		</div>
	</div>
	<div id="sf_admin_content">
		<table cellspacing="0" class="sf_admin_list" style="width: 842px;">
			<thead>
				<tr>
					<th id="sf_admin_list_th_page_id">
						{{ knp_pagination_sortable(pagination, 'Id', 'n.id') }}
						</th>
					<th id="sf_admin_list_th_parent_page_id">
						{{ knp_pagination_sortable(pagination, 'Paginas Relacionadas', 'n.parentPage') }}
						</th>
					<th id="sf_admin_list_th_name">
						{{ knp_pagination_sortable(pagination, 'Nombre', 'n.name') }}
					</th>
					<th id="sf_admin_list_th_background_id">
						{{ knp_pagination_sortable(pagination, 'Fondo', 'n.background') }}
						</th>
					<th id="sf_admin_list_th_media_id">
						{{ knp_pagination_sortable(pagination, 'Imagen', 'n.media') }}
						</th>
					<th id="sf_admin_list_th_theme_id">
						{{ knp_pagination_sortable(pagination, 'Tema', 'n.theme') }}
						</th>
					<th id="sf_admin_list_th_published">
						{{ knp_pagination_sortable(pagination, 'Publicado', 'n.published') }}
						
						</th>
					<th id="sf_admin_list_th_sf_actions">Acciones</th>
				</tr>
			</thead>

			<tbody>
				{%for object in objects%}
					{% include 'ProyectoPrincipalBundle:Page:List-Element.html.twig' with {'object': object} %}
				{%endfor%}
			</tbody>
			<tfoot>
				<tr>
					<th colspan="8">
					<div class="float-right navigation">
						<!--<a href="/admin.php/es/page/list/page/1"><img align="absmiddle" alt="First" title="First" src="{{asset('sf/sf_admin/images/first.png')}}"></a><a href="/admin.php/es/page/list/page/1"><img align="absmiddle" alt="Previous" title="Previous" src="{{asset('sf/sf_admin/images/previous.png')}}"></a>
						<span>1</span><a href="/admin.php/es/page/list/page/2">2</a>
						<a href="/admin.php/es/page/list/page/2"><img align="absmiddle" alt="Next" title="Next" src="{{asset('sf/sf_admin/images/next.png')}}"></a><a href="/admin.php/es/page/list/page/2"><img align="absmiddle" alt="Last" title="Last" src="{{asset('sf/sf_admin/images/last.png')}}"></a>
					-->
					 {{ knp_pagination_render(pagination) }}
					</div> 
					
					{{ pagination.getTotalItemCount }} resultados</th>
				</tr>
			</tfoot>
		</table>
		
		<ul class="sf_admin_actions">
			<li>
				<input class="sf_admin_action_create" value="Anadir" type="button" onclick="document.location.href='{{path('proyecto_principal_page_create')}}';">
			</li>
			<li>
				<input class="sf_admin_action_rank" value="Determinar orden" type="button" onclick="document.location.href='{{path('proyecto_principal_page_rank')}}';">
			</li>
		</ul>
	</div>
	<div id="sf_admin_footer"></div>
</div><!-- end whole contents -->
</td>
<script type="text/javascript">
jQuery('.eliminar').click(function() {  
 	var actual = jQuery(this);
 	var id = actual.parent().attr('clave'); 	
 	var data = 'id='+id;
	actual.parent().parent().parent().remove();
	
	jQuery.ajax({
		type : "POST",
		url : eliminarPagina,
		data : data,
		dataType : "json",
		success : function(data) {
								 }
	      });

    return false;
  });
 jQuery('.change_published').click(function() {  
 	var actual = jQuery(this);
 	var id = actual.attr('clave'); 	
 	var data = 'id='+id;
 	
 	var estado = actual.prev().css('display');
 	
 	if(estado == 'none'){
 		data +='&tarea=0';
 		actual.prev().prev().css('display','none');
 		actual.prev().css('display','block');
 	}
 	else{
 		data +='&tarea=1';
 		actual.prev().prev().css('display','block');
 		actual.prev().css('display','none');
 	}
	jQuery.ajax({
		type : "POST",
		url : cambiarStatusPagina,
		data : data,
		dataType : "json",
		success : function(data) {
								 }
	      });

    return false;
  });
</script>
{%endblock%}